-- @path ABCD=/bento.examples.analysis/tests/bento/tests/ABCD.ecore
-- @path WZYZ=/bento.examples.analysis/tests/bento/tests/WXYZ.ecore

module readtargetfeature;
create OUT : WXYZ from IN : ABCD;

rule model {
        from src : ABCD!Model 
        to   tgt : WXYZ!Model (
			name <- 'invented',
        	elements <- src.elements
		)
}

rule b {
	from
		a : ABCD!B 
	to 
		x : WXYZ!X (
			name <- 'anX',
			-- Invalid: "name" will be undefined
			propOfX <- WXYZ!Y.allInstances()->first().name
		)
}

rule c {
	from
		a : ABCD!C
	to 
		y : WXYZ!Y (
			name <- 'anY',
			-- This is valid because it is declared after "b" rule
			propOfY <- WXYZ!X.allInstances()->first().name
		)
}